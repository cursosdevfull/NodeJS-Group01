"use strict";var __importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.AuthenticationGuard=void 0;const header_util_1=require("../utils/header.util"),responses_util_1=__importDefault(require("../utils/responses.util")),token_service_1=require("../services/token.service");class AuthenticationGuard{static canActivate(e,t,s){const i=header_util_1.HeaderUtil.getHeader(e.headers,"authorization");if(i){const e=i.split(" ");if(e.length&&"bearer"===e[0].toLowerCase()){const i=e[1];token_service_1.TokenService.validateAccessToken(i).then(e=>{t.locals.roles=e.roles,s()}).catch(e=>{responses_util_1.default.send(t,e.status,{})})}else responses_util_1.default.send(t,401,{})}else responses_util_1.default.send(t,401,{})}}exports.AuthenticationGuard=AuthenticationGuard;